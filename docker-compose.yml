version: '3.8'

services:
  thought-pipeline:
    build: .
    container_name: thought-pipeline
    ports:
      - "127.0.0.1:3000:3000"  # Only accessible locally, not exposed to internet
    environment:
      - NODE_ENV=production
      - OPENAI_API_KEY=${OPENAI_API_KEY}
      - PORT=3000
    volumes:
      - ./data:/app/data
      - ./audio:/app/audio
      - ./recordings:/app/recordings
      - /home/niranjan/.openclaw/workspace/scout:/home/niranjan/.openclaw/workspace/scout:ro
    restart: unless-stopped
    dns:
      - 8.8.8.8
      - 1.1.1.1
    networks:
      - thought-pipeline-net

  thyme-bot:
    build: .
    container_name: thyme-bot
    command: npm run thyme
    environment:
      - NODE_ENV=production
      - THYME_BOT_TOKEN=${THYME_BOT_TOKEN}
    volumes:
      - ./:/app
    restart: unless-stopped
    depends_on:
      - thought-pipeline
    networks:
      - thought-pipeline-net

networks:
  thought-pipeline-net:
    driver: bridge
